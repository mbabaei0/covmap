<nz-page-header
  class="site-page-header"
  nzTitle="Progress of COVID-19 around the world."
  nzSubtitle="Dashboard showcasing the live progress of COVID-19 around the world."
></nz-page-header>

<nz-divider
  nzText="Select Filer to show data"
  nzOrientation="left"
></nz-divider>

<div
  *ngIf="dataService.stats$ | async as stats; else loading"
  nz-row
  [nzGutter]="16"
>
  <div nz-col class="gutter-row" [nzSpan]="14">
    <nz-card
      [nzBordered]="false"
      nzTitle="Click on map to see the result"
      [nzExtra]="extraTemplate"
    >
      <cov-map
        [countryId]="selectedCountry"
        [data]="stats"
        (select)="onSelectContry($event)"
        [filter]="filter"
      ></cov-map>
    </nz-card>
    <ng-template #extraTemplate>

      <nz-button-group>
        <button nz-button nzType="primary" nzDanger (click)="filterData('deaths')">
          Deaths
        </button>
        <button nz-button nzType="primary" (click)="filterData('cases')">
          Cases
        </button>
        <button nz-button nzType="primary" (click)="filterData('tests')">
          Tests
        </button>
      </nz-button-group>
      &nbsp;
      <i nz-icon nzType="filter" nzTheme="twotone"></i>
    </ng-template>
  </div>

  <div nz-col class="gutter-row" [nzSpan]="10">
    <nz-card [nzBordered]="false" nzTitle="Counstry Progress"  [nzExtra]="searchTemplate">
      <cov-country-chart
        [countryName]="selectedCountry"
        [data]="selectedNumbers"
        [labels]="chartLabels"
        [maxValue]="20"
      ></cov-country-chart>
    </nz-card>

    <ng-template #searchTemplate>
      <nz-date-picker [(ngModel)]="date" (ngModelChange)="onDateChange($event)"></nz-date-picker>
      &nbsp;
      <nz-select style="min-width: 150px;" nzShowSearch nzAllowClear nzPlaceHolder="Select a Country" (ngModelChange)="prepareChartData($event)" [(ngModel)]="selectedCountry">
        <nz-option *ngFor="let item of stats" [nzLabel]="item.country" [nzValue]="item.country"></nz-option>

      </nz-select>
      &nbsp;
      <i nz-icon nzType="sliders" nzTheme="twotone"></i>
    </ng-template>
  </div>
  <div nz-col class="gutter-row" [nzSpan]="6">
    <div class="inner-box">col-6</div>
  </div>
  <div nz-col class="gutter-row" [nzSpan]="6">
    <div class="inner-box">col-6</div>
  </div>
</div>

<div>
  Filter by : {{ filter }}
  <div></div>

  <!-- <li *ngFor="let item of stats">{{ item.percent }} {{ item.country }}</li> -->
</div>

<ng-template #loading>loading</ng-template>
